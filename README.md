# QRコード受付システム

## 基本的な要件定義

* 多言語対応を基本とし、利用者に入力してもらうフィールドのラベルなどは翻訳専用の画面（と専用の権限管理もしくはサイト管理者）で行う
  * それ以外のUIについては静的htmlの翻訳で対応する
* 利用者画面の要件
  * 利用者が送られてきた入力用URLに記入して登録すると、会場で提示する用のQRコード(と再度表示するためのURL)が発行される
  * 利用者の登録完了画面では、メール配信（QRコード画像添付）、カレンダーへの登録（QRコード表示用URL追加）、画像のダウンロードなど、可能な限りの保存メニューを提示する
  * 利用者が登録済みの情報を編集できるようにするかについては将来的な追加の可能性がある機能とする
* 受付時のフローについての要件
  * 受付で利用者がQRコードを提示してきた際、受付担当がQRコードのURLを開いた画面は、基本情報の表示とともに（ラベルに基づく）背景色を指定色で表示する
  * 当日の未登録は利用者画面の締め切りを当日受付締め切りより後に設定し、利用者の登録画面で対応する
* サイト管理者はイベントの新規追加と、既に存在するイベントの属性管理のみの権限とする
  * イベントの固有IDとは別に、入力画面用にIDを紐づけられるようにし、次年度でも同じイベントでは同じURLと見せられるようにする
* 各イベントの管理者向け画面の要件
  * URLと管理キーで管理画面を表示し、管理キーを入力して表示する際にUUIDなどでのセッションIDをアサインしトラックする
  * 管理者による編集はすべてログをデータベースに残す
  * イベントに関する情報や説明の編集、利用者に入力してもらう画面に配置するフィールドのリストの編集、公開期間（入力受付期間）の設定などを行えるようにする
  * 登録者にアサインするためのラベルを設定できるようにし、受付時にスタッフに表示する画面の背景色を設定できるようにする
  * 登録済み利用者一覧を一覧表示でき、また各フィールドとラベルを編集できるようにし、また管理者にしか見えないメモ領域を持つようにする

## URL設計

### ID設定

* `<event-id>`: 各イベントの人間可読性のある文字列IDで、サイト管理者が割り当て情報を更新する
* `<event-uuid>`: 各イベントの固有ID
* 利用者が登録した際に登録毎に割り当てるID
  * `<input-id-qr>`: QRコードを表示するためのID
  * `<input-id-reg>`: QRコードに埋め込まれる受付用のID

### URL

* `<base>/`: トップページは何らかの説明を記述するが、（利用マニュアル以外の）個別リンクなどは置かない
* `<base>/docs/`: 利用マニュアルを置く場合はここに入れる
* `<base>/input/<event-id>/`: 利用者の入力画面
* `<base>/qr/<input-id-qr>/`: 利用者向けQRコード表示用画面
* `<base>/reg/<input-id-reg>/`: 受付時にQRコードを読み込んで表示する画面
* `<base>/admin/`: サイト管理者用画面
* `<base>/event/edit/<event-uuid>/`: 各イベントの管理者向けイベント編集画面
* `<base>/event/list/<event-uuid>/`: 各イベントの管理者向け登録一覧・編集画面
* `<base>/api/`: APIエンドポイントのディレクトリ

## DB設計

[DB schema](db_schema.sql)

* サイト管理テーブル（イベントリスト）
* `<event-id>`管理テーブル
* イベント情報管理テーブル
* 入力フィールド翻訳データ
* 登録者データ (IDリスト、入力フィールドは含まない、受付完了データは入れる)
* 登録者の入力データテーブル
* 管理者操作ログ
